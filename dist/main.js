(()=>{"use strict";const t=function(){let t=!1;return{changeTurn:function(){t=!1===t},isTurn:function(){return t},resetTurn:function(){t=!1}}};function e(t){return Math.floor(Math.random()*(t+1))}function n(t,e){return t.x===e.x&&t.y===e.y}const r=function(){let t=[5,4,3,3,2],r=[],o=[];function i(t,e,o,i){const c=function(t,e,n,r){const o=[];for(let i=0;i<t;i+=1)"horizontal"===r?o.push({x:e+i,y:n}):o.push({x:e,y:n+i});return o}(t,e,o,i),s=function(t){let e=!0;for(let o=0;o<r.length;o+=1){const i=r[o].coordinates;if(t.filter((t=>i.some((e=>n(t,e))))).length){e=!1;break}}return e}(c),a=c.every((t=>{const{x:e,y:n}=t;return e>=0&&e<=9&&n>=0&&n<=9}));return!(!s||!a||(r.push(function(t,e){const n=t,r=new Array(n).fill(!1);return{length:n,hitPositions:r,coordinates:e,hit:function(t){t>=0&&t<n&&(r[t]=!0)},isSunk:function(){return r.every((t=>!0===t))}}}(t,c)),0))}function c(t,e){let o=null;for(let i=0;i<r.length;i+=1)if(r[i].coordinates.filter((r=>n(r,{x:t,y:e}))).length){o=r[i];break}return o}return{add:i,fill:function(){for(;5!==r.length;){const n=e(9),r=e(9),o=0===e(1)?"horizontal":"vertical";i(t[0],n,r,o)&&t.shift()}},getCoords:c,receiveAttack:function(t,e){const i=c(t,e);if(i){const o=function(t,e){let r=-1;for(let o=0;o<e.length;o+=1)if(n(e[o],t)){r=o;break}return r}({x:t,y:e},i.coordinates);return i.hit(o),void(i.isSunk()&&function(t){const e=function(t){return r.indexOf(t)}(t);r.splice(e,1)}(i))}var s;s={x:t,y:e},o.push(s)},getMissedShots:function(){return o},hasShips:function(){return r.length>0},getShips:function(){return r},reset:function(){t=[5,4,3,3,2],r=[],o=[]}}},o=function(){const t=document.querySelector(".player-gameboard"),e=document.querySelector(".computer-gameboard"),n=document.querySelector(".modal"),r=document.getElementById("winner"),o=document.getElementById("restart-game"),i=document.querySelector(".shuffle");function c(t){const e=document.createElement("div");e.classList.add("gameboard");for(let n=0;n<=9;n+=1){const r=document.createElement("div");r.classList.add("column");for(let e=0;e<=9;e+=1){const o=document.createElement("div");o.classList.add("square"),o.setAttribute("data-coordinate",`${n},${e}`),t.getCoords(n,e)&&o.classList.add("ship"),r.appendChild(o)}e.appendChild(r)}return e}function s(t){const e=t.querySelector(".gameboard");e&&t.removeChild(e)}return{renderGameBoards:function(n,r){s(t),s(e);const o=c(n),i=c(r);t.appendChild(o),e.appendChild(i)},triggerPlayOnGameBoardClick:function(t){e.querySelectorAll(".square").forEach((e=>e.addEventListener("click",t,{once:!0})))},getPlayerBoardSquare:function(e,n){let r;const o=t.querySelectorAll(".square");for(let t=0;t<o.length;t+=1){const i=o[t].getAttribute("data-coordinate").split(","),c=parseInt(i[0],10),s=parseInt(i[1],10);if(e===c&&n===s){r=o[t];break}}return r},setSuccessfulHit:function(t){t.classList.add("ship-hit")},setMissedShot:function(t){t.classList.add("missed-shot")},popUpModal:function(t){n.classList.toggle("active"),function(t){r.textContent=`${t} won!`}(t)},triggerGameRestartOnModalBtnClick:function(t){o.addEventListener("click",(e=>{t(e),n.classList.remove("active")}))},triggerBoardShuffle:function(t){i.addEventListener("click",t)}}}();(function(){const i=t(),c=r(),s=function(){const r=[];return{makePlay:function t(){const o={x:e(9),y:e(9)};var i;return i=o,r.some((t=>n(t,i)))?t():(function(t){r.push(t)}(o),o)},getPlays:function(){return r},...t()}}(),a=r();let u=!1;function l(t){t.fill()}function d(t){t.changeTurn()}function f(){i.changeTurn(),s.changeTurn()}function g(t){if(i.isTurn()&&!u){const e=t.target.getAttribute("data-coordinate").split(","),n=parseInt(e[0],10),r=parseInt(e[1],10),i=a.getCoords(n,r);a.receiveAttack(n,r),i?o.setSuccessfulHit(t.target):o.setMissedShot(t.target),a.hasShips()?(f(),function(){if(s.isTurn()&&!u){const t=s.makePlay(),{x:e,y:n}=t,r=c.getCoords(e,n);c.receiveAttack(e,n),r?o.setSuccessfulHit(o.getPlayerBoardSquare(e,n)):o.setMissedShot(o.getPlayerBoardSquare(e,n)),c.hasShips()?f():(o.popUpModal("Computer"),u=!0)}}()):(o.popUpModal("Player"),u=!0)}}function h(){c.reset(),a.reset(),i.resetTurn(),s.resetTurn(),u=!1,l(c),l(a),o.renderGameBoards(c,a),o.triggerPlayOnGameBoardClick(g),d(i)}return{start:function(){l(c),l(a),o.renderGameBoards(c,a),d(i),o.triggerPlayOnGameBoardClick(g),o.triggerGameRestartOnModalBtnClick(h),o.triggerBoardShuffle(h)}}})().start()})();